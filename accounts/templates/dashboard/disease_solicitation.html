{% extends 'dashboard/dashboard.html' %}
{% load crispy_forms_tags static %}

{% block item %}

    <div class="alert alert-warning" role="alert">
        <p>- Este formulário é uma <strong>solicitação</strong>. Um administrador do sistema avaliará o seu envio.</p>
    </div>

    {{ disease_form.errors }}
    <form method="POST">
        {% csrf_token %}
        <div class="mb-2">{{ disease_form.name_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.scientific_name_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.complementary_scientific_name_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.culture_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.cycle_disease|as_crispy_field }}</div>
        <div class="mb-2"> {{ disease_form.condition_text_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.management_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.symptoms_disease|as_crispy_field }}</div>
        <div class="mb-2">{{ disease_form.occurrence_regions_disease|as_crispy_field }}</div>

        <section id="chars_block" class="mb-2 row">
            {% for condition in conditions %}
                <article class="row" id="char-{{ condition.0 }}">
                    <div class="col-md-6">

                        <select value="{{ condition.1.characteristic.id }}" name="char-{{ condition.0 }}" data-id="{{ condition.0 }}"
                                class="select form-control">
                            <option value="" selected="">---------</option>

                            <option value="1">Temperatura mínima (em graus)</option>

                        </select>

                    </div>
                    <div class="col-md-5" id="charlabel-{{ condition.0 }}"><input class="form-control"
                                                                                  name="charval-{{ condition.0 }}"
                                                                                  type="number"
                                                                                  step="0.01"
                                                                                  value="{{ condition.1.val_to_str }}"></div>
                    {% if condition.0 != 0 %}
                        <p data-id="{{ condition.0 }}" class="btn btn-rm btn-danger rm-char col-md-1">X</p>
                    {% endif %}

                    <br/><br/></article>

            {% empty %}
                Nada a mostrar
            {% endfor %}
        </section>
        <p id="add-char" class="btn btn-secondary">Nova Característica</p>

        <div style="display: none">
            <div id="char-model">
                {{ disease_form.characteristic|as_crispy_field }}
            </div>
        </div>

        <div class="mb-2"> {{ disease_form.source_disease|as_crispy_field }}</div>

        <p class="fw-light mt-4">Campos marcados com * são obrigatórios</p>
        <button type="submit" class="btn btn-light">Enviar</button>
    </form>
{% endblock %}

{% block scripts %}
    <script>
        chars_inputs = {{ characteristics_inputs|safe }};
        if ("{{ conditions|safe }}") {
            cid = {{ conditions_lenght }};
            $('select.select').each(function () {
                $(this).val($(this).attr('value'))
            })
        } else {
            cid = 0;
        }

    </script>
{% endblock scripts %}